<!DOCTYPE html>
<!--
CHATTRIX BASE TEMPLATE
======================

Foundation template for the Chattrix real-time messaging application providing:

STRUCTURAL FEATURES:
- HTML5 semantic structure with proper accessibility attributes
- Responsive viewport configuration for mobile-first design
- Bootstrap 5 CSS framework integration for consistent UI components
- Custom CSS integration for chat-specific styling and theming
- Jinja2 template inheritance system for maintainable page structure

FUNCTIONALITY FEATURES:
- Flash message system for user feedback and error notifications
- Dark mode JavaScript functionality with localStorage persistence
- Template block system for flexible content injection
- Progressive enhancement support for JavaScript features

TEMPLATE BLOCKS:
- strTitle: Page-specific title content (default: "Chattrix")
- extraHead: Additional head content (CSS, meta tags, preload hints)
- mainContent: Primary page content area
- extraScripts: Page-specific JavaScript modules and initialization

ACCESSIBILITY FEATURES:
- Proper ARIA labels and semantic HTML structure
- High contrast color schemes for readability
- Keyboard navigation support
- Screen reader compatible flash messages
-->
<html lang="en">
<head>
    <!-- Character encoding and viewport configuration -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    
    <!-- Dynamic page title with application name fallback -->
    <title>{% block strTitle %}Chattrix - Real-Time Messaging{% endblock %}</title>
    
    <!-- Bootstrap CSS Framework for responsive UI components -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" 
          rel="stylesheet" 
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" 
          crossorigin="anonymous">
    
    <!-- Custom application stylesheet with chat-specific styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    
    <!-- Additional head content for page-specific requirements -->
    {% block extraHead %}{% endblock %}
</head>
<body>
    <!-- Flash Message System for User Feedback -->
    {% with arrMessages = get_flashed_messages(with_categories=true) %}
        {% if arrMessages %}
            <div class="flash-messages" role="alert" aria-live="polite">
                {% for strCategory, strMessage in arrMessages %}
                    <div class="alert alert-{{ 'danger' if strCategory == 'error' else 'success' }} alert-dismissible fade show" 
                         role="alert" 
                         aria-label="Notification message">
                        {{ strMessage }}
                        <button type="button" 
                                class="btn-close" 
                                data-bs-dismiss="alert" 
                                aria-label="Close notification">
                        </button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}
    
    <!-- Main Content Area -->
    <main role="main" aria-label="Main content">
        {% block mainContent %}{% endblock %}
    </main>
    

    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Base Dark Mode Script -->
    <script>
        /**
         * Dark mode toggle functionality with persistent user preference.
         * 
         * Features:
         * - Loads saved theme preference from localStorage on page load
         * - Toggles between light and dark modes with smooth transitions
         * - Updates toggle button icon (üåô for light mode, ‚òÄÔ∏è for dark mode)
         * - Persists user preference across browser sessions
         * - Applies dark-mode CSS class to body element for theme switching
         */
        document.addEventListener('DOMContentLoaded', function() {
            const darkModeToggle = document.getElementById('darkModeToggle');
            if (darkModeToggle) {
                const savedTheme = localStorage.getItem('darkMode');
                const isDarkMode = savedTheme === 'true' || savedTheme === 'enabled';
                
                if (isDarkMode) {
                    document.body.classList.add('dark-mode');
                    darkModeToggle.textContent = '‚òÄÔ∏è';
                } else {
                    document.body.classList.remove('dark-mode');
                    darkModeToggle.textContent = 'üåô';
                }
                
                darkModeToggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    const isDark = document.body.classList.toggle('dark-mode');
                    localStorage.setItem('darkMode', isDark ? 'enabled' : 'disabled');
                    darkModeToggle.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
                });
            }
        });
    </script>
    
    {% block extra_scripts %}{% endblock %}
</body>
</html>